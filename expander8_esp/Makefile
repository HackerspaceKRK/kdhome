# Generated by KD build system

CC=arm-none-eabi-gcc-col
CXX=arm-none-eabi-g++-col
OUTPUT=main.elf

F_CPU=8000000
RAMSIZE=10240

DEFINES=-DVERSION=2 -DSTM32F10X_MD -DPRINTF -DF_CPU=$(F_CPU) -DRAMSIZE=$(RAMSIZE)
INCLUDEPATH=-I. -Ikdusb -I../kdutils -I../ -I../providers -I../kdutils/uclibs -I../expander8/stm32-public
LIBS=-lm -lc

CFLAGS=-mcpu=cortex-m3 -march=armv7-m -mfix-cortex-m3-ldrd -msoft-float -mthumb -nostartfiles -ggdb -Werror=implicit -O1 -fdata-sections -ffunction-sections
CFLAGS+=$(DEFINES)
CFLAGS+=$(INCLUDEPATH)
LFLAGS=-Wl,--relax,--gc-sections -Wl,-gc-sections -Wl,-Map=build/$(OUTPUT).map -Wl,-T main.ld
LFLAGS+=$(LIBS)

all: prepare build/$(OUTPUT)
	arm-none-eabi-objcopy -O binary build/$(OUTPUT) build/$(OUTPUT).bin
	arm-none-eabi-objcopy -O ihex build/$(OUTPUT) build/$(OUTPUT).hex
	arm-none-eabi-objdump -h -S build/$(OUTPUT) > build/$(OUTPUT).lst
	arm-none-eabi-size build/$(OUTPUT)

prepare:
	mkdir -p build/

build/main.o: main.c
	$(CC) $(CFLAGS) -c $< -o $@

build/esp.o: esp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/isr.o: isr.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__expander8_io.o: ../expander8/io.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__expander8_temp.o: ../expander8/temp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__expander8_ir.o: ../expander8/ir.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__kdutils_uclibs_cli.o: ../kdutils/uclibs/cli.c
	$(CC) $(CFLAGS) -c $< -o $@

build/_home_krystiand_prog__uc_armtest_arm-public_delay.o: /home/krystiand/prog/_uc/armtest/arm-public/delay.c
	$(CC) $(CFLAGS) -c $< -o $@

build/_home_krystiand_prog__uc_armtest_arm-public_myprintf.o: /home/krystiand/prog/_uc/armtest/arm-public/myprintf.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_providers.o: ../providers/providers.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_provider_input.o: ../providers/provider_input.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_provider_ir.o: ../providers/provider_ir.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_provider_temp.o: ../providers/provider_temp.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__providers_provider_output.o: ../providers/provider_output.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__kdutils_uclibs_advinputmanager.o: ../kdutils/uclibs/advinputmanager.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__expander8_stm32-public_ow.o: ../expander8/stm32-public/ow.c
	$(CC) $(CFLAGS) -c $< -o $@

build/__3rd_IRremote.o: ../3rd/IRremote.c
	$(CC) $(CFLAGS) -c $< -o $@

build/$(OUTPUT): build/main.o build/esp.o build/isr.o build/__expander8_io.o build/__expander8_temp.o build/__expander8_ir.o build/__kdutils_uclibs_cli.o build/_home_krystiand_prog__uc_armtest_arm-public_delay.o build/_home_krystiand_prog__uc_armtest_arm-public_myprintf.o build/__providers_providers.o build/__providers_provider_input.o build/__providers_provider_ir.o build/__providers_provider_temp.o build/__providers_provider_output.o build/__kdutils_uclibs_advinputmanager.o build/__expander8_stm32-public_ow.o build/__3rd_IRremote.o
	$(CC) $(CFLAGS) $(LFLAGS) $^ -o $@

